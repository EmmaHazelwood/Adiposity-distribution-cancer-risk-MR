# Adiposity Distribution and Cancer Risk MR Analyses


Code used for all analyses in the paper:

> Hazelwood, E., Goudswaard, L. J., Lee, M. A., Vabistsevits, M., Pournaras, D. J., Brenner, H., Buchanan, D. D., Gruber, S. B., Gsur, A., Li, L., Vodickova, L., Grant, R. C., Samadder, N. J., Timpson, N. J., Gunter, M. J., Schuster-Böckler, B., Yarmolinsky, J., Richardson, T. G., Freisling, H., Murphy, N., & Vincent, E. E. (2025). *Adiposity distribution and risks of twelve obesity-related cancers: a Mendelian randomization analysis*. https://doi.org/10.1101/2025.01.10.25320324

---

## Table of Contents

- [Overview of Scripts](#overview-of-scripts)  
- [Step-by-Step Walkthrough](#step-by-step-walkthrough)  
- [Acknowledgements](#acknowledgements)

---

## Overview of Scripts

All scripts used in the analyses described in the paper can be found in this repository. These include scripts used to:

### Format GWAS data

1. [Formatting Neale lab cancer GWAS.R]()  
2. [Extracting GWAS from OpenGWAS for meta-analysis with metal.R]()  
3. [Getting rsID for IGF1 and CRP summary data.R]()  
4. [Formatting sex-specific GWAS.R]()

### Construct genetic instruments

1. [Generating ASAT VAT and GFAT instruments.R]()  
2. [Making male measures of adiposity instruments.R]()  
3. [Formatting adiposity trait genetic instruments.R]()  
4. [Instruments for molecular traits.R]()  
5. [F stats and r2.R]()

### Perform the meta-analysis of UK Biobank and FinnGen cancer risk GWAS

1. [METAL_meta_analysis_script_1.txt]()  
2. [METAL_meta_analysis_script_2.txt]()  
3. [Filtering meta-analysis results.R]()  
4. [Formatting all meta-analysed SNPs.R]()

### Conduct MR analyses

1. [Adiposity measures cancer MR.R]()  
2. [Adiposity measures to molecular traits MR.R]()  
3. [MR BMI onto all cancers.R]()  
4. [Sex-specific MRs.R]()  
5. [Repeating MRs without sample overlap.R]()

### Perform multivariable MR

1. [Creating files for MVMR]()  
2. [MVMR molecular mechanisms]()  
3. [MVMR sensitivity analyses.R]()

### Make figures

1. [Figures.R]()  
2. [Power curves.R]()  
3. [Genetic correlations matrix]()

### Make tables

1. [Tables.R]()

### Calculate genetic correlations

1. [Genetic correlation.txt]()

Scripts are numbered in the order in which they were run. Most were written in R, making extensive use of the [`TwoSampleMR`](https://mrcieu.github.io/TwoSampleMR/) package.

All summary genetic data generated by the meta-analyses are available via the [GWAS Catalogue]() (GCST accession number: XXX).

---

## Step-by-Step Walkthrough for Adiposity Traits–Cancer Risk MR

Below is a detailed step-by-step guide for the main analysis: an MR of adiposity traits on cancer risk, as described in the paper. As noted above, see the [`TwoSampleMR` GitHub guide](https://mrcieu.github.io/TwoSampleMR/) for more detail on how to perform MR in R.

### Step 1: Generating Genetic Instruments for Adiposity Traits

Summary genetic data for ASAT, VAT, and GFAT were obtained from:

*paper*

Summary genetic data for liver fat and pancreas fat were obtained from:

*paper*

While the liver fat and pancreas fat GWAS are available in [OpenGWAS]() and can be read directly into R via [`TwoSampleMR`](https://mrcieu.github.io/TwoSampleMR/), the ASAT, VAT, and GFAT data required reformatting.

I downloaded these data from:

*link*

Then I ran script [1_Generating ASAT VAT and GFAT instruments.R]() to reformat them and selected genetic instruments based on genome-wide significance (*P* < 5 × 10<sup>−8</sup>) and LD independence (r² < 0.001), using the `format_data` and `clump_data` functions from [`TwoSampleMR`](https://mrcieu.github.io/TwoSampleMR/).

I then applied further formatting and excluded SNPs with F-statistics < 10 in script [10_Formatting adiposity trait genetic instruments.R]().

### Step 2: Formatting Cancer GWAS

Minor reformatting of cancer GWAS data was performed using [2_Formatting Neale lab cancer GWAS.R]() and [5_Extracting GWAS from OpenGWAS for meta-analysis with metal.R]().

### Step 3: Meta-Analysis of Cancer GWAS (UK Biobank and FinnGen)

Meta-analysis was conducted using METAL (v2011-03-25). For details, see the [METAL documentation](https://genome.sph.umich.edu/wiki/METAL_Documentation).

Two METAL scripts were used:

- [6_METAL_meta_analysis_script_1.txt]() loads and meta-analyses the UK Biobank and FinnGen data per cancer, adjusting for population stratification.
- [7_METAL_meta_analysis_script_2.txt]() applies a second round of genomic control correction.

Effective sample sizes were calculated as recommended in:

> Willer CJ, Li Y, Abecasis GR. *METAL: fast and efficient meta-analysis of genomewide association scans*. Bioinformatics. 2010;26(17):2190–2191. doi: [10.1093/bioinformatics/btq340](https://doi.org/10.1093/bioinformatics/btq340)

with the formula:

$$
N_\text{eff} = \frac{4}{\frac{1}{N_\text{cases}} + \frac{1}{N_\text{controls}}}
$$

After meta-analysis, I filtered SNPs with *P*<sub>heterogeneity</sub> < 0.05 and reformatted the data using [8_Filtering meta-analysis results.R]() and [9_Formatting all meta-analysed SNPs.R]().

### Step 4: MR of Adiposity Traits to Cancer Risk

MR analyses were conducted in R using [`TwoSampleMR`](https://mrcieu.github.io/TwoSampleMR/), and a modified version of Dr Matt Lee’s [`proxy_search`](#) function (included in [11_Adiposity measures cancer MR.R]()) to identify proxy SNPs. Steiger filtering was used to remove instruments explaining more outcome than exposure variance.

The same approach was used for all other MR analyses, including those involving molecular traits and sex-specific data.

---

## Acknowledgements

This GitHub walkthrough was created by Emma Hazelwood in May 2025. I would like to acknowledge my co-authors, as well as the funders and participants who made this work possible.
